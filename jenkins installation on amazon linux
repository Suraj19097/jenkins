#!/bin/bash
# Script to install Jenkins on Amazon Linux 2023
# Author: Suraj Patil

set -e

echo "ğŸ”¹ Updating system packages..."
sudo dnf update -y

echo "ğŸ”¹ Installing Java 17 (Amazon Corretto)..."
sudo dnf install java-17-amazon-corretto -y

echo "âœ… Java version installed:"
java -version

echo "ğŸ”¹ Adding Jenkins repository..."
sudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo
sudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io-2023.key

echo "ğŸ”¹ Installing Jenkins..."
sudo dnf install jenkins -y

echo "ğŸ”¹ Enabling and starting Jenkins service..."
sudo systemctl enable jenkins
sudo systemctl start jenkins

echo "âœ… Jenkins service status:"
sudo systemctl status jenkins --no-pager

echo "ğŸ”¹ Fetching initial admin password..."
sudo cat /var/lib/jenkins/secrets/initialAdminPassword

echo "ğŸ‰ Jenkins installation completed successfully!"
echo "ğŸ‘‰ Access Jenkins at: http://<your-ec2-public-ip>:8080"
